- name: Check if my_package is installed
  command: dpkg-query -W my_package
  register: my_package_check_deb
  failed_when: my_package_check_deb.rc > 1
  changed_when: my_package_check_deb.rc == 1

- name: Download logstash for Debian
  get_url:
    url="https://artifacts.elastic.co/downloads/logstash/logstash-{{ logstash_version }}.deb"
    dest="/tmp/logstash-{{ logstash_version }}.deb"
  when: my_package_check_deb.rc == 1

- name: Install Logstash for Debian systems
  apt: deb="/tmp/logstash-{{ logstash_version }}.deb"
  when: my_package_check_deb.rc == 1

# - name: Create logstash service file
#   copy:
#     src: files/logstash.svc
#     dest: /etc/init.d/logstash.svc
#     owner: root
#     group: root
#     mode: 0755
#   when: ansible_os_family == "Debian"
#
# - name: Make sure logstash is running and enabled Debian
#   service:
#     name: logstash.svc
#     enabled: yes
#     state: started
#     daemon_reload: yes
#   when: ansible_os_family == "Debian"
